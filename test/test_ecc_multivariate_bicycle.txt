@testitem "ECC Multivaraite Bicycle LP" begin
    using Hecke
    using Hecke: group_algebra, GF, abelian_group, gens
    using QuantumClifford.ECC: LPCode, code_k, code_n

    @testset "Weight-4 QLDPC Codes" begin
        # [[112, 8, 5]]
        l=7; m=8
        GA = group_algebra(GF(2), abelian_group([l, m]))
        x = gens(GA)[1]
        y = gens(GA)[2]
        z = x*y
        A = reshape([z^2 + z^6], (1, 1))
        B = reshape([x + x^6], (1, 1))
        c = LPCode(A, B)
        @test code_n(c) == 112 &&  code_k(c) == 8

        # [[64, 2, 8]]
        l=8; m=4
        GA = group_algebra(GF(2), abelian_group([l, m]))
        x = gens(GA)[1]
        y = gens(GA)[2]
        z = x*y
        A = reshape([x + x^2], (1, 1))
        B = reshape([x^3 + y], (1, 1))
        c = LPCode(A, B)
        @test code_n(c) == 64 &&  code_k(c) == 2

        # [[72, 2, 8]]
        l=4; m=9
        GA = group_algebra(GF(2), abelian_group([l, m]))
        x = gens(GA)[1]
        y = gens(GA)[2]
        z = x*y
        A = reshape([x + y^2], (1, 1))
        B = reshape([x^2 + y^2], (1, 1))
        c = LPCode(A, B)
        @test code_n(c) == 72 &&  code_k(c) == 2

        # [[96, 2, 8]]
        l=6; m=8
        GA = group_algebra(GF(2), abelian_group([l, m]))
        x = gens(GA)[1]
        y = gens(GA)[2]
        z = x*y
        A = reshape([x^5 + y^6], (1, 1))
        B = reshape([z + z^4], (1, 1))
        c = LPCode(A, B)
        @test code_n(c) == 96 &&  code_k(c) == 2

        # [[112, 2, 10]]
        l=7; m=8
        GA = group_algebra(GF(2), abelian_group([l, m]))
        x = gens(GA)[1]
        y = gens(GA)[2]
        z = x*y
        A = reshape([z^6 + x^5], (1, 1))
        B = reshape([z^2 + y^5], (1, 1))
        c = LPCode(A, B)
        @test code_n(c) == 112 &&  code_k(c) == 2

        # [[144, 2, 12]]
        l=8; m=9
        GA = group_algebra(GF(2), abelian_group([l, m]))
        x = gens(GA)[1]
        y = gens(GA)[2]
        z = x*y
        A = reshape([x^3 + y^7], (1, 1))
        B = reshape([x + y^5], (1, 1))
        c = LPCode(A, B)
        @test code_n(c) == 144 &&  code_k(c) == 2
    end

    @testset "Weight-5 QLDPC Codes" begin
        # [[30, 4, 5]]
        l=3; m=5
        GA = group_algebra(GF(2), abelian_group([l, m]))
        x = gens(GA)[1]
        y = gens(GA)[2]
        z = x*y
        A = reshape([x + z^4], (1, 1))
        B = reshape([x + y^2 + z^2 ], (1, 1))
        c = LPCode(A, B)
        @test code_n(c) == 30 &&  code_k(c) == 4

        # [[72, 4, 8]]
        l=4; m=9
        GA = group_algebra(GF(2), abelian_group([l, m]))
        x = gens(GA)[1]
        y = gens(GA)[2]
        z = x*y
        A = reshape([x + y^3], (1, 1))
        B = reshape([x^2 + y + y^2 ], (1, 1))
        c = LPCode(A, B)
        @test code_n(c) == 72 &&  code_k(c) == 4

        # [96, 4, 8]]
        l=8; m=6
        GA = group_algebra(GF(2), abelian_group([l, m]))
        x = gens(GA)[1]
        y = gens(GA)[2]
        z = x*y
        A = reshape([x^6 + x^3], (1, 1))
        B = reshape([z^5 + x^5 + y ], (1, 1))
        c = LPCode(A, B)
        @test code_n(c) == 96 &&  code_k(c) == 4
    end

    @testset "Weight-6 QLDPC codes" begin
        # [[30, 6, 4]]
        l=5; m=3
        GA = group_algebra(GF(2), abelian_group([l, m]))
        x = gens(GA)[1]
        y = gens(GA)[2]
        z = x*y
        A = reshape([x^4 + z^3], (1, 1))
        B = reshape([x^4 + x + z^4 + y], (1, 1))
        c = LPCode(A, B)
        @test code_n(c) == 30 &&  code_k(c) == 6

        # [[48, 6, 6]]
        l=4; m=6
        GA = group_algebra(GF(2), abelian_group([l, m]))
        x = gens(GA)[1]
        y = gens(GA)[2]
        z = x*y
        A = reshape([x^2 + y^4], (1, 1))
        B = reshape([x^3 + z^3 + y^2 + y], (1, 1))
        c = LPCode(A, B)
        @test code_n(c) == 48 &&  code_k(c) == 6

        # [[40, 4, 6]]
        l=4; m=5
        GA = group_algebra(GF(2), abelian_group([l, m]))
        x = gens(GA)[1]
        y = gens(GA)[2]
        z = x*y
        A = reshape([x^2 + y], (1, 1))
        B = reshape([y^4 + y^2 + x^3 + x], (1, 1))
        c = LPCode(A, B)
        @test code_n(c) == 40 &&  code_k(c) == 4

        # [[48, 4, 6]]
        l=4; m=6
        GA = group_algebra(GF(2), abelian_group([l, m]))
        x = gens(GA)[1]
        y = gens(GA)[2]
        z = x*y
        A = reshape([x^3 + y^5], (1, 1))
        B = reshape([x + z^5 + y^5 + y^2], (1, 1))
        c = LPCode(A, B)
        @test code_n(c) == 48 &&  code_k(c) == 4
    end

    @testset "Weight-7 QLDPC codes" begin
        # [[30, 4, 5]]
        l=5; m=3;
        GA = group_algebra(GF(2), abelian_group([l, m]));
        x = gens(GA)[1]
        y = gens(GA)[2]
        z = x*y
        A = reshape([x^4 + x^2], (1, 1))
        B = reshape([x + x^2 + y + z^2 + z^3], (1, 1))
        c = LPCode(A, B)
        @test code_n(c) == 30 &&  code_k(c) == 4
    end
end
